{% extends "base.html" %}
{% set category = "accounting" %}
{% block title %}Accounting log{% endblock %}
{% block head %}
{{ super() }}
<script type="text/javascript" src="/static/jquery-latest.js"></script> 
<script type="text/javascript" src="/static/jquery.tablesorter.js"></script> 
<script type="text/javascript">
        $(function() { $("#transactions").tablesorter(); } ); 
</script>
{% endblock %}
{% block content %}
<form method="post" class="cf" id="filter">
    {{ form.hidden_tag() }}
    {{ form.amount }}
    {{ form.bank_id }}
    {{ form.category_id }}
    {{ form.submit }}
</form>
<table id="transactions">
    <thead>
        <tr>
            <th>#</th>
            <th>Date</th>
            <th>Amount</th>
            <th>to/from</th>
            <th>Description</th>
            <th>Category</th>
            <th>Bank account</th>
            {% if 'finances' in session.roles %}
            <th>Bank statement</th>
            <th>Date filed</th>
            <th>Filed by</th>
            <th>Modify</th>
            {% endif %}
        </tr>
    </thead>
    <tbody>
        {% for transaction in log %}
        <tr>
            <td>{{ transaction.id }}</td>
            <td>{% if transaction.date %}{{ transaction.date }}{% else %}<span class="red">not payed yet!</span>{% endif %}</td>
            <td>{% if transaction.amount > 0 %}<span class="green">+{% else %}<span class="red">{% endif%}â‚¬{{ transaction.amount }}</span></td>
            <td>{{ transaction.to_from }}</td>
            <td>{{ transaction.description }}</td>
            <td>{{ transaction.category.name }}</td>
            <td>{{ transaction.bank.name }}</td>
            {% if 'finances' in session.roles %}
            <td>{% if transaction.bank_statement_number%}{{transaction.bank_statement_number}}{% endif %}</td>
            <td>{{ transaction.date_filed }}</td>
            <td>{{ transaction.filed_by.name }}</td>
            <td><a href="/accounting/edit_{{transaction.id}}"><img src="/static/edit.gif" alt="edit transaction" /></a></td>
            {% endif %}
        </tr>
        {% endfor %}
    </tbody>
</table>
{% from "_macros.html" import render_pagination %}
{{ render_pagination(pagination) }}
{% endblock %}
